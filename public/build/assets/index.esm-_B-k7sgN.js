import{r,c as O}from"./app-v2ba8NM4.js";var y=function(){return y=Object.assign||function(n){for(var s,u=1,i=arguments.length;u<i;u++)for(var e in s=arguments[u])Object.prototype.hasOwnProperty.call(s,e)&&(n[e]=s[e]);return n},y.apply(this,arguments)};function F(n,s,u,i){return new(u||(u=Promise))(function(e,l){function o(a){try{m(i.next(a))}catch(t){l(t)}}function d(a){try{m(i.throw(a))}catch(t){l(t)}}function m(a){var t;a.done?e(a.value):(t=a.value,t instanceof u?t:new u(function(f){f(t)})).then(o,d)}m((i=i.apply(n,[])).next())})}function L(n,s){var u,i,e,l,o={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(m){return function(a){return function(t){if(u)throw new TypeError("Generator is already executing.");for(;l&&(l=0,t[0]&&(o=0)),o;)try{if(u=1,i&&(e=2&t[0]?i.return:t[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,t[1])).done)return e;switch(i=0,e&&(t=[2&t[0],e.value]),t[0]){case 0:case 1:e=t;break;case 4:return o.label++,{value:t[1],done:!1};case 5:o.label++,i=t[1],t=[0];continue;case 7:t=o.ops.pop(),o.trys.pop();continue;default:if(e=o.trys,!((e=e.length>0&&e[e.length-1])||t[0]!==6&&t[0]!==2)){o=0;continue}if(t[0]===3&&(!e||t[1]>e[0]&&t[1]<e[3])){o.label=t[1];break}if(t[0]===6&&o.label<e[1]){o.label=e[1],e=t;break}if(e&&o.label<e[2]){o.label=e[2],o.ops.push(t);break}e[2]&&o.ops.pop(),o.trys.pop();continue}t=s.call(n,o)}catch(f){t=[6,f],i=0}finally{u=e=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([m,a])}}}typeof SuppressedError=="function"&&SuppressedError,function(n){if(typeof window>"u")return;const s=document.createElement("style");s.setAttribute("type","text/css"),s.innerHTML=n,document.head.appendChild(s)}(".simplePDF_container{-webkit-user-select:none;-moz-user-select:none;user-select:none;position:fixed;display:flex;box-sizing:border-box;align-items:center;justify-content:center;height:100vh;width:100%;z-index:999999;padding:16px;top:0;left:0;background:rgba(0,0,0,.5)}.simplePDF_content{width:100%;height:100%;position:relative;box-sizing:border-box}.simplePDF_iframeContainer{overflow:hidden;background:#f1f7ff;border-radius:6px;width:100%;height:100%}.simplePDF_iframe{border:none;border-radius:6px;width:100%;height:100%}.simplePDF_close{z-index:1;position:absolute;top:-12px;right:-12px;border:none;padding:6px;border-radius:50px;display:flex;align-items:center;justify-content:center;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.24);cursor:pointer;background:#ff5959;text-shadow:1px 1px #243889}.simplePDF_close svg{fill:#fff;width:14px;height:14px}.simplePDF_close:hover{box-shadow:0 2px 4px rgba(0,0,0,.1),0 4px 4px rgba(0,0,0,.24)}");var U=function(){return r.createElement("svg",{height:"512",viewBox:"0 0 512 512",width:"512",xmlSpace:"preserve",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M443.6 387.1 312.4 255.4l131.5-130c5.4-5.4 5.4-14.2 0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L256 197.8 124.9 68.3c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L68 105.9c-5.4 5.4-5.4 14.2 0 19.6l131.5 130L68.4 387.1c-2.6 2.6-4.1 6.1-4.1 9.8 0 3.7 1.4 7.2 4.1 9.8l37.4 37.6c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1L256 313.1l130.7 131.1c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1l37.4-37.6c2.6-2.6 4.1-6.1 4.1-9.8-.1-3.6-1.6-7.1-4.2-9.7z"}))},k=function(n){return n.mode==="inline"},C=r.forwardRef(function(n,s){var u=n.className,i=n.style;return r.createElement("iframe",{ref:s,className:u,style:y({border:0},i)})}),M=r.forwardRef(function(n,s){var u=n.children,i=n.editorURL,e=r.useState(!1),l=e[0],o=e[1],d=r.useCallback(function(a){a.preventDefault(),o(!0)},[]),m=r.useCallback(function(){o(!1)},[]);return r.createElement(r.Fragment,null,l&&O.createPortal(r.createElement("div",{className:"simplePDF_container","aria-modal":"true"},r.createElement("div",{className:"simplePDF_content"},r.createElement("button",{onClick:m,className:"simplePDF_close","aria-label":"Close PDF editor modal"},r.createElement(U,null)),r.createElement("div",{className:"simplePDF_iframeContainer"},r.createElement("iframe",{ref:s,referrerPolicy:"no-referrer-when-downgrade",className:"simplePDF_iframe",src:i})))),document.body),r.cloneElement(u,{onClick:d}))}),T=function(n){var s,u,i,e,l=n.context,o=n.companyIdentifier,d=n.locale,m=r.useState({type:null,value:null,isEditorReady:!1}),a=m[0],t=m[1],f=r.useRef(null),g=k(n)?(s=n.documentURL)!==null&&s!==void 0?s:null:(e=(i=(u=n.children)===null||u===void 0?void 0:u.props)===null||i===void 0?void 0:i.href)!==null&&e!==void 0?e:null;r.useEffect(function(){g&&F(void 0,void 0,void 0,function(){var c,h,v;return L(this,function(p){switch(p.label){case 0:return[4,fetch(g,{method:"GET",credentials:"same-origin"})];case 1:if(!(c=p.sent()).ok)throw new Error("Failed to retrieve the document: ".concat(JSON.stringify({status:c.status,url:g})));return[4,c.blob()];case 2:return h=p.sent(),v=new FileReader,[4,new Promise(function(w,b){v.onload=w,v.onerror=b,v.readAsDataURL(h)})];case 3:return p.sent(),[2,v.result]}})}).then(function(c){return t(function(h){return y(y({},h),{type:"iframe_event",value:c})})}).catch(function(){t(function(c){return y(y({},c),{type:"cors_proxy_fallback",value:g})})})},[g]);var E=r.useMemo(function(){return"https://".concat(o??"embed",".simplepdf.com")},[o]);r.useEffect(function(){a.isEditorReady&&a.type==="iframe_event"&&a.value!==null&&function(c){var h=c.iframeRef,v=c.documentDataURL,p=c.editorDomain;F(void 0,void 0,void 0,function(){var w,b,x;return L(this,function(D){return w=new URL(p),(x=(b=h.current)===null||b===void 0?void 0:b.contentWindow)===null||x===void 0||x.postMessage(JSON.stringify({type:"LOAD_DOCUMENT",data:{data_url:v}}),w.origin),[2]})})}({iframeRef:f,documentDataURL:a.value,editorDomain:E})},[a,E]);var _=r.useCallback(function(c){return F(void 0,void 0,void 0,function(){var h,v,p,w,b,x;return L(this,function(D){switch(D.label){case 0:if(h=new URL(c.origin).origin,v=new URL(E).origin,h!==v)return[2];if(c.source!==((b=f.current)===null||b===void 0?void 0:b.contentWindow))return[2];switch(p=function(){try{return JSON.parse(c.data)}catch{return console.error("Failed to parse iFrame event payload"),null}}(),p==null?void 0:p.type){case"EDITOR_READY":return[3,1];case"DOCUMENT_LOADED":case"SUBMISSION_SENT":return[3,2]}return[3,6];case 1:return t(function(S){return y(y({},S),{isEditorReady:!0})}),[2];case 2:return D.trys.push([2,4,,5]),[4,(x=n.onEmbedEvent)===null||x===void 0?void 0:x.call(n,p)];case 3:return D.sent(),[3,5];case 4:return w=D.sent(),console.error("onEmbedEvent failed to execute: ".concat(JSON.stringify(w))),[3,5];case 5:case 6:return[2]}})})},[n.onEmbedEvent,E]);r.useEffect(function(){return window.addEventListener("message",_,!1),function(){return window.removeEventListener("message",_)}},[_]);var P=r.useMemo(function(){if(!l)return null;try{return encodeURIComponent(btoa(JSON.stringify(l)))}catch(c){return console.error("Failed to encode the context: ".concat(JSON.stringify(c)),{context:l}),null}},[JSON.stringify(l)]),R=r.useMemo(function(){var c=new URL("/".concat(d??"en","/editor"),E);return P&&c.searchParams.set("context",P),g&&c.searchParams.set("loadingPlaceholder","true"),(a==null?void 0:a.type)==="cors_proxy_fallback"&&(a==null?void 0:a.value)!==null&&c.searchParams.set("open",a.value),c.href},[E,g,P,a,d]),N=k(n);return r.useEffect(function(){N&&f&&f.current&&(f.current.src=R)},[R,N]),N?r.createElement(C,{className:n.className,style:n.style,ref:f}):r.createElement(M,{children:n.children,editorURL:R,ref:f})};export{T as u};
