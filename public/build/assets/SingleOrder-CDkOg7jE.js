import{r as i,j as e,e as I,W as A,y as B,a as J}from"./app-DTXfO_M1.js";import{D as E}from"./Disclose-DPbRJmoB.js";import{M as W}from"./Modal-eh9MvMoi.js";import{u as H,S as V}from"./Swal-D_fOGzxe.js";import{B as S}from"./Button-CXXq4qht.js";import{T as U}from"./TrashIcon--wLkShQE.js";import{I as $}from"./InputError-BmXuuYBP.js";import{F as T}from"./PlusIcon-yeguXIEZ.js";import{F as q}from"./ChevronRightIcon-B3xVvXdn.js";import{C as P}from"./Currency-ydQLzPWB.js";function G({title:t,titleId:n,...l},a){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":n},l),t?i.createElement("title",{id:n},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const Q=i.forwardRef(G);function Y({title:t,titleId:n,...l},a){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":n},l),t?i.createElement("title",{id:n},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const Z=i.forwardRef(Y),K={test:"TEST",medication:"MEDICATION",appointment:"appointment"};function X({...t}){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:[e.jsx("g",{clipPath:"url(#clip0_3840_4479)",children:e.jsx("path",{d:"M10.6676 10.6666L8.00095 7.99995M8.00095 7.99995L5.33428 10.6666M8.00095 7.99995V13.9999M13.5943 12.2599C14.2445 11.9055 14.7582 11.3445 15.0542 10.6657C15.3502 9.98686 15.4118 9.22877 15.2291 8.51107C15.0464 7.79338 14.6299 7.15696 14.0454 6.70225C13.4609 6.24754 12.7415 6.00044 12.001 5.99995H11.161C10.9592 5.21944 10.5831 4.49484 10.0609 3.88061C9.53877 3.26638 8.88418 2.77852 8.14635 2.45369C7.40852 2.12886 6.60665 1.97552 5.80103 2.0052C4.99541 2.03489 4.20699 2.24682 3.49507 2.62506C2.78314 3.0033 2.16622 3.53802 1.6907 4.189C1.21517 4.83999 0.89341 5.59031 0.749603 6.38354C0.605797 7.17678 0.643687 7.9923 0.860426 8.76879C1.07716 9.54528 1.46711 10.2625 2.00095 10.8666",stroke:"#16D671",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_3840_4479",children:e.jsx("rect",{width:"16",height:"16",fill:"white"})})})]})}var g=function(){return g=Object.assign||function(t){for(var n,l=1,a=arguments.length;l<a;l++)for(var r in n=arguments[l])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},g.apply(this,arguments)};function L(t,n,l,a){return new(l||(l=Promise))(function(r,c){function o(d){try{f(a.next(d))}catch(s){c(s)}}function m(d){try{f(a.throw(d))}catch(s){c(s)}}function f(d){var s;d.done?r(d.value):(s=d.value,s instanceof l?s:new l(function(h){h(s)})).then(o,m)}f((a=a.apply(t,[])).next())})}function F(t,n){var l,a,r,c,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function m(f){return function(d){return function(s){if(l)throw new TypeError("Generator is already executing.");for(;c&&(c=0,s[0]&&(o=0)),o;)try{if(l=1,a&&(r=2&s[0]?a.return:s[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(r=o.trys,!((r=r.length>0&&r[r.length-1])||s[0]!==6&&s[0]!==2)){o=0;continue}if(s[0]===3&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(s[0]===6&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=n.call(t,o)}catch(h){s=[6,h],a=0}finally{l=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([f,d])}}}typeof SuppressedError=="function"&&SuppressedError,function(t){if(typeof window>"u")return;const n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=t,document.head.appendChild(n)}(".simplePDF_container{-webkit-user-select:none;-moz-user-select:none;user-select:none;position:fixed;display:flex;box-sizing:border-box;align-items:center;justify-content:center;height:100vh;width:100%;z-index:999999;padding:16px;top:0;left:0;background:rgba(0,0,0,.5)}.simplePDF_content{width:100%;height:100%;position:relative;box-sizing:border-box}.simplePDF_iframeContainer{overflow:hidden;background:#f1f7ff;border-radius:6px;width:100%;height:100%}.simplePDF_iframe{border:none;border-radius:6px;width:100%;height:100%}.simplePDF_close{z-index:1;position:absolute;top:-12px;right:-12px;border:none;padding:6px;border-radius:50px;display:flex;align-items:center;justify-content:center;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.24);cursor:pointer;background:#ff5959;text-shadow:1px 1px #243889}.simplePDF_close svg{fill:#fff;width:14px;height:14px}.simplePDF_close:hover{box-shadow:0 2px 4px rgba(0,0,0,.1),0 4px 4px rgba(0,0,0,.24)}");var ee=function(){return i.createElement("svg",{height:"512",viewBox:"0 0 512 512",width:"512",xmlSpace:"preserve",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M443.6 387.1 312.4 255.4l131.5-130c5.4-5.4 5.4-14.2 0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L256 197.8 124.9 68.3c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L68 105.9c-5.4 5.4-5.4 14.2 0 19.6l131.5 130L68.4 387.1c-2.6 2.6-4.1 6.1-4.1 9.8 0 3.7 1.4 7.2 4.1 9.8l37.4 37.6c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1L256 313.1l130.7 131.1c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1l37.4-37.6c2.6-2.6 4.1-6.1 4.1-9.8-.1-3.6-1.6-7.1-4.2-9.7z"}))},M=function(t){return t.mode==="inline"},te=i.forwardRef(function(t,n){var l=t.className,a=t.style;return i.createElement("iframe",{ref:n,className:l,style:g({border:0},a)})}),re=i.forwardRef(function(t,n){var l=t.children,a=t.editorURL,r=i.useState(!1),c=r[0],o=r[1],m=i.useCallback(function(d){d.preventDefault(),o(!0)},[]),f=i.useCallback(function(){o(!1)},[]);return i.createElement(i.Fragment,null,c&&I.createPortal(i.createElement("div",{className:"simplePDF_container","aria-modal":"true"},i.createElement("div",{className:"simplePDF_content"},i.createElement("button",{onClick:f,className:"simplePDF_close","aria-label":"Close PDF editor modal"},i.createElement(ee,null)),i.createElement("div",{className:"simplePDF_iframeContainer"},i.createElement("iframe",{ref:n,referrerPolicy:"no-referrer-when-downgrade",className:"simplePDF_iframe",src:a})))),document.body),i.cloneElement(l,{onClick:m}))}),z=function(t){var n,l,a,r,c=t.context,o=t.companyIdentifier,m=t.locale,f=i.useState({type:null,value:null,isEditorReady:!1}),d=f[0],s=f[1],h=i.useRef(null),w=M(t)?(n=t.documentURL)!==null&&n!==void 0?n:null:(r=(a=(l=t.children)===null||l===void 0?void 0:l.props)===null||a===void 0?void 0:a.href)!==null&&r!==void 0?r:null;i.useEffect(function(){w&&L(void 0,void 0,void 0,function(){var u,v,x;return F(this,function(p){switch(p.label){case 0:return[4,fetch(w,{method:"GET",credentials:"same-origin"})];case 1:if(!(u=p.sent()).ok)throw new Error("Failed to retrieve the document: ".concat(JSON.stringify({status:u.status,url:w})));return[4,u.blob()];case 2:return v=p.sent(),x=new FileReader,[4,new Promise(function(b,j){x.onload=b,x.onerror=j,x.readAsDataURL(v)})];case 3:return p.sent(),[2,x.result]}})}).then(function(u){return s(function(v){return g(g({},v),{type:"iframe_event",value:u})})}).catch(function(){s(function(u){return g(g({},u),{type:"cors_proxy_fallback",value:w})})})},[w]);var N=i.useMemo(function(){return"https://".concat(o??"embed",".simplepdf.com")},[o]);i.useEffect(function(){d.isEditorReady&&d.type==="iframe_event"&&d.value!==null&&function(u){var v=u.iframeRef,x=u.documentDataURL,p=u.editorDomain;L(void 0,void 0,void 0,function(){var b,j,y;return F(this,function(C){return b=new URL(p),(y=(j=v.current)===null||j===void 0?void 0:j.contentWindow)===null||y===void 0||y.postMessage(JSON.stringify({type:"LOAD_DOCUMENT",data:{data_url:x}}),b.origin),[2]})})}({iframeRef:h,documentDataURL:d.value,editorDomain:N})},[d,N]);var D=i.useCallback(function(u){return L(void 0,void 0,void 0,function(){var v,x,p,b,j,y;return F(this,function(C){switch(C.label){case 0:if(v=new URL(u.origin).origin,x=new URL(N).origin,v!==x)return[2];if(u.source!==((j=h.current)===null||j===void 0?void 0:j.contentWindow))return[2];switch(p=function(){try{return JSON.parse(u.data)}catch{return console.error("Failed to parse iFrame event payload"),null}}(),p==null?void 0:p.type){case"EDITOR_READY":return[3,1];case"DOCUMENT_LOADED":case"SUBMISSION_SENT":return[3,2]}return[3,6];case 1:return s(function(O){return g(g({},O),{isEditorReady:!0})}),[2];case 2:return C.trys.push([2,4,,5]),[4,(y=t.onEmbedEvent)===null||y===void 0?void 0:y.call(t,p)];case 3:return C.sent(),[3,5];case 4:return b=C.sent(),console.error("onEmbedEvent failed to execute: ".concat(JSON.stringify(b))),[3,5];case 5:case 6:return[2]}})})},[t.onEmbedEvent,N]);i.useEffect(function(){return window.addEventListener("message",D,!1),function(){return window.removeEventListener("message",D)}},[D]);var _=i.useMemo(function(){if(!c)return null;try{return encodeURIComponent(btoa(JSON.stringify(c)))}catch(u){return console.error("Failed to encode the context: ".concat(JSON.stringify(u)),{context:c}),null}},[JSON.stringify(c)]),k=i.useMemo(function(){var u=new URL("/".concat(m??"en","/editor"),N);return _&&u.searchParams.set("context",_),w&&u.searchParams.set("loadingPlaceholder","true"),(d==null?void 0:d.type)==="cors_proxy_fallback"&&(d==null?void 0:d.value)!==null&&u.searchParams.set("open",d.value),u.href},[N,w,_,d,m]),R=M(t);return i.useEffect(function(){R&&h&&h.current&&(h.current.src=k)},[k,R]),R?i.createElement(te,{className:t.className,style:t.style,ref:h}):i.createElement(re,{children:t.children,editorURL:k,ref:h})};function ne({onChange:t=null}){const[n,l]=i.useState([]),a=c=>{const o=c.currentTarget.files;for(let m=0;m<o.length;m++){const f=o[m];f.preview=URL.createObjectURL(f),l([...n,f])}},r=c=>{c.preventDefault(),l([])};return i.useEffect(()=>{t&&t(n)},[n]),e.jsxs("label",{className:"p-5 min-h-40 flex items-center justify-center border border-dashed border-[#0000001A] rounded-xl",children:[e.jsx(E,{show:n.length<1,children:e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("div",{children:e.jsx("div",{className:"p-2 bg-[#6768FB0D] rounded-full",children:e.jsx(X,{className:"size-5"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Click to Upload"}),e.jsx("p",{className:"text-muted text-xs",children:"PDF - 10MB max."}),e.jsx("input",{type:"file",hidden:!0,accept:".pdf",onChange:a})]})]})}),e.jsx(E,{show:n.length>0,children:n.map((c,o)=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("div",{children:e.jsx("div",{className:"p-2 bg-[#6768FB0D] rounded-full",children:e.jsx(Q,{className:"size-6 text-primary"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:c.name}),e.jsxs("p",{className:"text-muted text-xs",children:["Last Modified: ",c.lastModifiedDate.toDateString()]})]})]}),e.jsxs("div",{className:"flex  space-x-3 justify-center",children:[e.jsx(z,{children:e.jsx("a",{href:c.preview,className:"btn btn-light p-1 px-2",children:"Preview"})}),e.jsxs(S,{onClick:r,className:"btn-light p-1 px-2 text-red-600",children:[e.jsx(U,{className:"stroke-red-600"})," Remove"]})]})]},o))})]})}const se=({order:t})=>{var c;const n=H(),l=A({files:[]});function a(){l.post(route("orders.tests.upload",{order:t.order_item_id}),{onSuccess(){n.close(),l.reset()}})}function r(){var o;B.get(route("orders.tests.delete",{order:t.order_item_id,testResult:(o=t.result)==null?void 0:o.id}))}return e.jsxs(e.Fragment,{children:[e.jsxs(E,{show:!t.result,children:[e.jsx("button",{onClick:n.open,className:"inline-flex rounded-lg py-2 px-3 text-primary hover:bg-primary/20 bg-primary/10",children:"Upload result"}),e.jsx(W,{className:"py-0 !max-w-2xl",...n,children:e.jsxs("div",{className:"md:flex md:divide-x",children:[e.jsxs("div",{className:"md:w-1/2 pt-5 md:pe-6",children:[e.jsx("h4",{className:"font-semibold",children:"Complete Order"}),e.jsx("p",{className:"text-muted text-sm",children:"To complete this order upload the test result for patient use"})]}),e.jsxs("div",{className:"md:w-1/2 py-5 md:ps-6 space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"Upload Test Result"}),e.jsxs("div",{children:[e.jsx(ne,{onChange:o=>l.setData("files",o)}),e.jsx($,{message:l.errors.files})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{onClick:n.close,className:"btn-light",children:"Cancel"}),e.jsxs(S,{className:"btn-primary flex-1",loading:l.processing,onClick:a,children:["Upload test result ",e.jsx(T,{className:"size-4"})]})]})]})]})})]}),e.jsx(E,{show:!!t.result,children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(z,{children:e.jsxs("a",{href:(c=t.result)==null?void 0:c.result,className:"text-primary flex space-x-4 items-center",children:["View Test Result ",e.jsx(q,{className:"size-4"})]})}),e.jsx(V,{onConfirm:r,type:"warning",onClick:r,className:"",children:e.jsx(U,{className:"size-5 stroke-red-600"})})]})})]})};function ie({order:t}){return e.jsxs("tr",{children:[e.jsx("td",{children:t.product_name}),e.jsx("td",{children:t.product_type}),e.jsx("td",{children:t.quantity}),e.jsxs("td",{children:[e.jsx(P,{})," ",t.price.toLocaleString()]}),e.jsxs("td",{children:[e.jsx(P,{})," ",(t.price*t.quantity).toLocaleString()]}),e.jsx("td",{className:"text-left",children:e.jsx(E,{show:t.product_type==K.test,children:e.jsx(se,{order:t})})})]})}function xe({order:t}){const[n,l]=i.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:n?"bg-gray-50":"",children:[e.jsx("td",{children:e.jsx("p",{className:"link",children:t.id})}),e.jsx("td",{children:e.jsx(J,{href:route("patients.show",{id:t.user.id}),className:"link",children:t.user.full_name})}),e.jsxs("td",{children:[e.jsx(P,{})," ",t.amount]}),e.jsx("td",{children:t.status}),e.jsx("td",{children:t.date}),e.jsx("td",{children:t.is_order_paid?"Paid":"Unpaid"}),e.jsx("td",{className:"text-left flex gap-2",children:e.jsx("button",{className:"border-2 p-1 bg-white rounded-lg",onClick:()=>l(!n),children:n?e.jsx(Z,{className:"size-4"}):e.jsx(T,{className:"size-4"})})})]}),e.jsx(E,{show:n,children:e.jsx("tr",{children:e.jsxs("td",{colSpan:9,className:"bg-gray-50",children:[e.jsx("div",{className:"mb-2",children:e.jsx("h4",{className:"font-medium",children:"Order Items"})}),e.jsx("table",{children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Product Name"}),e.jsx("th",{children:"Product Type"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Action"})]}),t.items.map(a=>e.jsx(ie,{order:a},a.order_item_id))]})})]})})})]})}export{xe as S};
